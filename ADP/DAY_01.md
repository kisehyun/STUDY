---
title: "ADP_Day_01"
author: "kisehyun"
date: '2020 11 19 '
output: html_document
---



# R을 활용한 ADP 실기 study 1일차

### 주성분 분석, 요인분석 및 정규화, 표준화 코드 공부


## 1. 주성분분석


**주성분 분석**은 **서로 상관성이 높은 변수들의 선형결합**으로 이루어진 **'주성분'**이라는 변수로 **변수들을 요약**하고 **축소**하는 기법이다.

```r
library(datasets)
data("USArrests")
head(USArrests)
```

```
##            Murder Assault UrbanPop Rape
## Alabama      13.2     236       58 21.2
## Alaska       10.0     263       48 44.5
## Arizona       8.1     294       80 31.0
## Arkansas      8.8     190       50 19.5
## California    9.0     276       91 40.6
## Colorado      7.9     204       78 38.7
```



```r
pairs(USArrests, panel = panel.smooth,  main = 'USArrests data')
```

![plot of chunk unnamed-chunk-1](figure/unnamed-chunk-1-1.png)


```r
usprcomp = princomp(USArrests, cor = T)
summary(usprcomp)
```

```
## Importance of components:
##                           Comp.1    Comp.2    Comp.3     Comp.4
## Standard deviation     1.5748783 0.9948694 0.5971291 0.41644938
## Proportion of Variance 0.6200604 0.2474413 0.0891408 0.04335752
## Cumulative Proportion  0.6200604 0.8675017 0.9566425 1.00000000
```
주성분 분석 결과는 **summary**함수를 적용하여 확인할 수 잇다. **Proportion of Variance**는 주성분의 기율, **Cumulative Proportion**은 누적기여율을 의미한다.


```r
plot(usprcomp, type = 'l')
```

![plot of chunk unnamed-chunk-3](figure/unnamed-chunk-3-1.png)


```r
usprcomp$loadings
```

```
## 
## Loadings:
##          Comp.1 Comp.2 Comp.3 Comp.4
## Murder    0.536  0.418  0.341  0.649
## Assault   0.583  0.188  0.268 -0.743
## UrbanPop  0.278 -0.873  0.378  0.134
## Rape      0.543 -0.167 -0.818       
## 
##                Comp.1 Comp.2 Comp.3 Comp.4
## SS loadings      1.00   1.00   1.00   1.00
## Proportion Var   0.25   0.25   0.25   0.25
## Cumulative Var   0.25   0.50   0.75   1.00
```
주성분 분석 결과의 **loading**을 통해서 **주성분계수** 즉 각 변수가 주성분에 **기여하는 가중치**를 알 수 있다. 각 성분과 계수들을 이용하여 **선형결합식**을 생성할 수 있다.

```r
usprcomp$scores
```

```
##                     Comp.1      Comp.2      Comp.3       Comp.4
## Alabama         0.98556588  1.13339238  0.44426879  0.156267145
## Alaska          1.95013775  1.07321326 -2.04000333 -0.438583440
## Arizona         1.76316354 -0.74595678 -0.05478082 -0.834652924
## Arkansas       -0.14142029  1.11979678 -0.11457369 -0.182810896
## California      2.52398013 -1.54293399 -0.59855680 -0.341996478
## Colorado        1.51456286 -0.98755509 -1.09500699  0.001464887
## Connecticut    -1.35864746 -1.08892789  0.64325757 -0.118469414
## Delaware        0.04770931 -0.32535892  0.71863294 -0.881977637
## Florida         3.01304227  0.03922851  0.57682949 -0.096284752
## Georgia         1.63928304  1.27894240  0.34246008  1.076796812
## Hawaii         -0.91265715 -1.57046001 -0.05078189  0.902806864
## Idaho          -1.63979985  0.21097292 -0.25980134 -0.499104101
## Illinois        1.37891072 -0.68184119  0.67749564 -0.122021292
## Indiana        -0.50546136 -0.15156254 -0.22805484  0.424665700
## Iowa           -2.25364607 -0.10405407 -0.16456432  0.017555916
## Kansas         -0.79688112 -0.27016470 -0.02555331  0.206496428
## Kentucky       -0.75085907  0.95844029  0.02836942  0.670556671
## Louisiana       1.56481798  0.87105466  0.78348036  0.454728038
## Maine          -2.39682949  0.37639158  0.06568239 -0.330459817
## Maryland        1.76336939  0.42765519  0.15725013 -0.559069521
## Massachusetts  -0.48616629 -1.47449650  0.60949748 -0.179598963
## Michigan        2.10844115 -0.15539682 -0.38486858  0.102372019
## Minnesota      -1.69268181 -0.63226125 -0.15307043  0.067316885
## Mississippi     0.99649446  2.39379599  0.74080840  0.215508013
## Missouri        0.69678733 -0.26335479 -0.37744383  0.225824461
## Montana        -1.18545191  0.53687437 -0.24688932  0.123742227
## Nebraska       -1.26563654 -0.19395373 -0.17557391  0.015892888
## Nevada          2.87439454 -0.77560020 -1.16338049  0.314515476
## New Hampshire  -2.38391541 -0.01808229 -0.03685539 -0.033137338
## New Jersey      0.18156611 -1.44950571  0.76445355  0.243382700
## New Mexico      1.98002375  0.14284878 -0.18369218 -0.339533597
## New York        1.68257738 -0.82318414  0.64307509 -0.013484369
## North Carolina  1.12337861  2.22800338  0.86357179 -0.954381667
## North Dakota   -2.99222562  0.59911882 -0.30127728 -0.253987327
## Ohio           -0.22596542 -0.74223824  0.03113912  0.473915911
## Oklahoma       -0.31178286 -0.28785421  0.01530979  0.010332321
## Oregon          0.05912208 -0.54141145 -0.93983298 -0.237780688
## Pennsylvania   -0.88841582 -0.57110035  0.40062871  0.359061124
## Rhode Island   -0.86377206 -1.49197842  1.36994570 -0.613569430
## South Carolina  1.32072380  1.93340466  0.30053779 -0.131466685
## South Dakota   -1.98777484  0.82334324 -0.38929333 -0.109571764
## Tennessee       0.99974168  0.86025130 -0.18808295  0.652864291
## Texas           1.35513821 -0.41248082  0.49206886  0.643195491
## Utah           -0.55056526 -1.47150461 -0.29372804 -0.082314047
## Vermont        -2.80141174  1.40228806 -0.84126309 -0.144889914
## Virginia       -0.09633491  0.19973529 -0.01171254  0.211370813
## Washington     -0.21690338 -0.97012418 -0.62487094 -0.220847793
## West Virginia  -2.10858541  1.42484670 -0.10477467  0.131908831
## Wisconsin      -2.07971417 -0.61126862  0.13886500  0.184103743
## Wyoming        -0.62942666  0.32101297  0.24065923 -0.166651801
```
주성분 점수는 **score**인자로 확인할 수 있으며 **biplot**을 그릴 때 좌표로 활용할 수 있다.

```r
biplot(usprcomp, scale = 0)
```

![plot of chunk unnamed-chunk-6](figure/unnamed-chunk-6-1.png)

## 2. 요인분석


```r
data(swiss)
str(swiss)
```

```
## 'data.frame':	47 obs. of  6 variables:
##  $ Fertility       : num  80.2 83.1 92.5 85.8 76.9 76.1 83.8 92.4 82.4 82.9 ...
##  $ Agriculture     : num  17 45.1 39.7 36.5 43.5 35.3 70.2 67.8 53.3 45.2 ...
##  $ Examination     : int  15 6 5 12 17 9 16 14 12 16 ...
##  $ Education       : int  12 9 5 7 15 7 7 8 7 13 ...
##  $ Catholic        : num  9.96 84.84 93.4 33.77 5.16 ...
##  $ Infant.Mortality: num  22.2 22.2 20.2 20.3 20.6 26.6 23.6 24.9 21 24.4 ...
```

```r
min = apply(swiss, 2, min)
max = apply(swiss, 2, max)
swiss_fa = scale(swiss, center = min, scale = (max - min))
```


```r
factanal(swiss_fa, factors = 3)
```

```
## 
## Call:
## factanal(x = swiss_fa, factors = 3)
## 
## Uniquenesses:
##        Fertility      Agriculture      Examination        Education         Catholic Infant.Mortality 
##            0.005            0.286            0.213            0.114            0.083            0.743 
## 
## Loadings:
##                  Factor1 Factor2 Factor3
## Fertility        -0.512   0.203   0.832 
## Agriculture      -0.774   0.312  -0.129 
## Examination       0.751  -0.423  -0.211 
## Education         0.901          -0.262 
## Catholic         -0.186   0.913   0.220 
## Infant.Mortality                  0.500 
## 
##                Factor1 Factor2 Factor3
## SS loadings      2.273   1.164   1.120
## Proportion Var   0.379   0.194   0.187
## Cumulative Var   0.379   0.573   0.759
## 
## The degrees of freedom for the model is 0 and the fit was 1e-04
```

## 3. 표준화 및 정규화


```r
data(mtcars)
str(mtcars)
```

```
## 'data.frame':	32 obs. of  11 variables:
##  $ mpg : num  21 21 22.8 21.4 18.7 18.1 14.3 24.4 22.8 19.2 ...
##  $ cyl : num  6 6 4 6 8 6 8 4 4 6 ...
##  $ disp: num  160 160 108 258 360 ...
##  $ hp  : num  110 110 93 110 175 105 245 62 95 123 ...
##  $ drat: num  3.9 3.9 3.85 3.08 3.15 2.76 3.21 3.69 3.92 3.92 ...
##  $ wt  : num  2.62 2.88 2.32 3.21 3.44 ...
##  $ qsec: num  16.5 17 18.6 19.4 17 ...
##  $ vs  : num  0 0 1 1 0 1 0 1 1 1 ...
##  $ am  : num  1 1 1 0 0 0 0 0 0 0 ...
##  $ gear: num  4 4 4 3 3 3 3 4 4 4 ...
##  $ carb: num  4 4 1 1 2 1 4 2 2 4 ...
```

```r
head(mtcars)
```

```
##                    mpg cyl disp  hp drat    wt  qsec vs am gear carb
## Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
## Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
## Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1
## Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1
## Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2
## Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1
```

```r
test.cars = mtcars[,c('mpg','hp')]
test.cars = transform(test.cars, mpg_scale = scale(test.cars$mpg), hp_scale = scale(test.cars$hp))
head(test.cars)
```

```
##                    mpg  hp  mpg_scale   hp_scale
## Mazda RX4         21.0 110  0.1508848 -0.5350928
## Mazda RX4 Wag     21.0 110  0.1508848 -0.5350928
## Datsun 710        22.8  93  0.4495434 -0.7830405
## Hornet 4 Drive    21.4 110  0.2172534 -0.5350928
## Hornet Sportabout 18.7 175 -0.2307345  0.4129422
## Valiant           18.1 105 -0.3302874 -0.6080186
```


```r
min = min(iris$Sepal.Length)
max = max(iris$Sepal.Length)

iris$SL_new = scale(iris$Sepal.Length, center = min, scale = max - min)
head(iris)
```

```
##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species id group sumlen     SL_new
## 1          5.1         3.5          1.4         0.2  setosa  1     B    6.5 0.22222222
## 2          4.9         3.0          1.4         0.2  setosa  2     A    6.3 0.16666667
## 3          4.7         3.2          1.3         0.2  setosa  3     B    6.0 0.11111111
## 4          4.6         3.1          1.5         0.2  setosa  4     A    6.1 0.08333333
## 5          5.0         3.6          1.4         0.2  setosa  5     B    6.4 0.19444444
## 6          5.4         3.9          1.7         0.4  setosa  6     A    7.1 0.30555556
```

자체 함수를 제작하여 정규화를 진행할 수 있다.

```r
normalize = function(x){
  return ((x - min(x)) / (max(x) - min(x)))
}
num = c(0:500)
normalize(num)
```

```
##   [1] 0.000 0.002 0.004 0.006 0.008 0.010 0.012 0.014 0.016 0.018 0.020 0.022 0.024 0.026 0.028 0.030 0.032 0.034 0.036
##  [20] 0.038 0.040 0.042 0.044 0.046 0.048 0.050 0.052 0.054 0.056 0.058 0.060 0.062 0.064 0.066 0.068 0.070 0.072 0.074
##  [39] 0.076 0.078 0.080 0.082 0.084 0.086 0.088 0.090 0.092 0.094 0.096 0.098 0.100 0.102 0.104 0.106 0.108 0.110 0.112
##  [58] 0.114 0.116 0.118 0.120 0.122 0.124 0.126 0.128 0.130 0.132 0.134 0.136 0.138 0.140 0.142 0.144 0.146 0.148 0.150
##  [77] 0.152 0.154 0.156 0.158 0.160 0.162 0.164 0.166 0.168 0.170 0.172 0.174 0.176 0.178 0.180 0.182 0.184 0.186 0.188
##  [96] 0.190 0.192 0.194 0.196 0.198 0.200 0.202 0.204 0.206 0.208 0.210 0.212 0.214 0.216 0.218 0.220 0.222 0.224 0.226
## [115] 0.228 0.230 0.232 0.234 0.236 0.238 0.240 0.242 0.244 0.246 0.248 0.250 0.252 0.254 0.256 0.258 0.260 0.262 0.264
## [134] 0.266 0.268 0.270 0.272 0.274 0.276 0.278 0.280 0.282 0.284 0.286 0.288 0.290 0.292 0.294 0.296 0.298 0.300 0.302
## [153] 0.304 0.306 0.308 0.310 0.312 0.314 0.316 0.318 0.320 0.322 0.324 0.326 0.328 0.330 0.332 0.334 0.336 0.338 0.340
## [172] 0.342 0.344 0.346 0.348 0.350 0.352 0.354 0.356 0.358 0.360 0.362 0.364 0.366 0.368 0.370 0.372 0.374 0.376 0.378
## [191] 0.380 0.382 0.384 0.386 0.388 0.390 0.392 0.394 0.396 0.398 0.400 0.402 0.404 0.406 0.408 0.410 0.412 0.414 0.416
## [210] 0.418 0.420 0.422 0.424 0.426 0.428 0.430 0.432 0.434 0.436 0.438 0.440 0.442 0.444 0.446 0.448 0.450 0.452 0.454
## [229] 0.456 0.458 0.460 0.462 0.464 0.466 0.468 0.470 0.472 0.474 0.476 0.478 0.480 0.482 0.484 0.486 0.488 0.490 0.492
## [248] 0.494 0.496 0.498 0.500 0.502 0.504 0.506 0.508 0.510 0.512 0.514 0.516 0.518 0.520 0.522 0.524 0.526 0.528 0.530
## [267] 0.532 0.534 0.536 0.538 0.540 0.542 0.544 0.546 0.548 0.550 0.552 0.554 0.556 0.558 0.560 0.562 0.564 0.566 0.568
## [286] 0.570 0.572 0.574 0.576 0.578 0.580 0.582 0.584 0.586 0.588 0.590 0.592 0.594 0.596 0.598 0.600 0.602 0.604 0.606
## [305] 0.608 0.610 0.612 0.614 0.616 0.618 0.620 0.622 0.624 0.626 0.628 0.630 0.632 0.634 0.636 0.638 0.640 0.642 0.644
## [324] 0.646 0.648 0.650 0.652 0.654 0.656 0.658 0.660 0.662 0.664 0.666 0.668 0.670 0.672 0.674 0.676 0.678 0.680 0.682
## [343] 0.684 0.686 0.688 0.690 0.692 0.694 0.696 0.698 0.700 0.702 0.704 0.706 0.708 0.710 0.712 0.714 0.716 0.718 0.720
## [362] 0.722 0.724 0.726 0.728 0.730 0.732 0.734 0.736 0.738 0.740 0.742 0.744 0.746 0.748 0.750 0.752 0.754 0.756 0.758
## [381] 0.760 0.762 0.764 0.766 0.768 0.770 0.772 0.774 0.776 0.778 0.780 0.782 0.784 0.786 0.788 0.790 0.792 0.794 0.796
## [400] 0.798 0.800 0.802 0.804 0.806 0.808 0.810 0.812 0.814 0.816 0.818 0.820 0.822 0.824 0.826 0.828 0.830 0.832 0.834
## [419] 0.836 0.838 0.840 0.842 0.844 0.846 0.848 0.850 0.852 0.854 0.856 0.858 0.860 0.862 0.864 0.866 0.868 0.870 0.872
## [438] 0.874 0.876 0.878 0.880 0.882 0.884 0.886 0.888 0.890 0.892 0.894 0.896 0.898 0.900 0.902 0.904 0.906 0.908 0.910
## [457] 0.912 0.914 0.916 0.918 0.920 0.922 0.924 0.926 0.928 0.930 0.932 0.934 0.936 0.938 0.940 0.942 0.944 0.946 0.948
## [476] 0.950 0.952 0.954 0.956 0.958 0.960 0.962 0.964 0.966 0.968 0.970 0.972 0.974 0.976 0.978 0.980 0.982 0.984 0.986
## [495] 0.988 0.990 0.992 0.994 0.996 0.998 1.000
```
